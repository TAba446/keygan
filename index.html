<script>
  const key = "X8besJ3wZdXuVF";

  function encryptText(text) {
    let result = '';
    for (let i = 0; i < text.length; i++) {
      let charCode = text.charCodeAt(i);
      let keyChar = key.charCodeAt(i % key.length);
      let encryptedCharCode = (charCode + keyChar) % 65535; // جلوگیری از overflow
      result += String.fromCharCode(encryptedCharCode);
    }
    // تبدیل به base64 به صورت ایمن
    return btoa(unescape(encodeURIComponent(result)));
  }

  function encrypt() {
    const input = document.getElementById('input').value;
    if (!input.trim()) {
      alert("لطفاً کدی وارد کنید!");
      return;
    }
    const encoded = encryptText(input);
    document.getElementById('output').value = encoded;
  }

  function copyOutput() {
    const output = document.getElementById('output');
    output.select();
    output.setSelectionRange(0, 99999);
    document.execCommand('copy');
    alert("کپی شد!");
  }
</script>
